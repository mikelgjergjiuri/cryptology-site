---
layout: default
title: Hill Cipher
subpages:
  - article:
    title: Article
    link: /classical-ciphers/hill/article.html
---

<script language="JavaScript" type="text/JavaScript">
function Encode (text){
  var i, j=0, t, uc, et=new Array(), k;
  t=""+text+"";
  for(i=0; i<(t.length); i++){
    uc = t.charCodeAt(i);
    if(uc >= 97 && uc <= 122){k = uc-97; et[j]=k; j++;}
	if(uc >= 65 && uc <= 90){k= uc-65; et[j] = k; j++;}}
  return et;	
}

function getGCD(n, m) {
var w, x, y;
x = n;
y = m;
while (y != 0) {
w = x % y;
x = y;
y = w;
}
return x;
}

function Hill_encipher(a, b, c, d, text){
   var t, eta = new Array(), tb = new Array(), i, j, det, etb = new Array(), et;
   t = Encode(text);
   //compute determinant
   det = (a*d - b*c)%26;
   //check if there is an inverse 
   if(getGCD(det, 26) !=1){alert("Invalid key matrix: No inverse exist mod 26. Please, use another key matrix."); return;}
   //padd text w/ 'z's
   if(t.length % 2 != 0){t[t.length]= 25}
   j = 0;
   //enciphering
   for (i=0; i<t.length; i++){
     tb[j] = t[i];
	 if(j == 1){j = 0; etb[0] = (a*tb[0] + b*tb[1]) % 26; etb[1] = (c*tb[0] + d*tb[1]) % 26; eta = eta.concat(etb);}
	 else{j++}}
   et="";
   //convert from Unicode to Character representation	 
   for(i=0; i<(eta.length); i++){et = et + String.fromCharCode(eta[i] + 65);}
   return(et);
}

function Hill_decipher(a, b, c, d, text){
   var t, tb = new Array(), i, j, det, etb = new Array(), eta = new Array(), et, a1, b1, c1, d1, indet;
   t = Encode(text);
   det = (a*d - b*c)%26;
   if(getGCD(det, 26) !=1){alert("Invalid key matrix: No inverse exist mod 26. Please, use another key matrix."); return;}
   if(t.length % 2 != 0){t[t.length]= 25}
   //compute elements of inverse matrix
   i=0;
   while(1){if ((26*i+1)%det == 0){indet = (26*i+1)/det; break;} else {i++}}//compute determinant inverse
   a1=(d*indet)%26; if(a1<0){a1=a1+26;} 
   b1=((-b)*indet)%26; if(b1<0){b1=b1+26;}
   c1=((-c)*indet)%26; if(c1<0){c1=c1+26;}
   d1=(a*indet)%26; if(d1<0){d1=d1+26;}
   //deciphering
   j=0;
   for (i=0; i<t.length; i++){
     tb[j] = t[i];
	 if(j == 1){j = 0; etb[0] = (a1*tb[0] + b1*tb[1]) % 26; etb[1] = (c1*tb[0] + d1*tb[1]) % 26; eta = eta.concat(etb)}
	 else{j++}}
   et="";
   //convert from Unicode to Character representation	 
   for(i=0; i<(eta.length); i++){et = et + String.fromCharCode(eta[i] + 97);}
   return(et);
   
}
</script>
<table width="933" border="0" cellpadding="0" cellspacing="0">
  <tr> 

    <td bgcolor="#FFFFFF" height="8" width="752"> 

      <p class="style12">Hill Cipher Interactive Demo</p>
      <table width="768" border="0" cellpadding="0" cellspacing="0" height="176">
        <tr>
          <td bgcolor="#FFFFFF" width="766" height="2" colspan="2">
            <p class="style9">&nbsp;</p>
            <p class="style9">Step1.
            Enter numbers in the matrix key.</p>
          </td>
        </tr>
        <tr>
          <td bgcolor="#FFFFFF" width="766" height="2" colspan="2">
            <form action method="post" name="hill" id="hill">
              <table width="767" border="0" cellpadding="3" cellspacing="3" class="textstyle" height="581">
                <tr>
                  <td width="751" height="84">
                    <table width="791">
                      <tr>
                        <td width="777" align="center">
                          <table cellSpacing="3" cellPadding="3" width="274" border="0" height="70">
                            <tbody>
                              <tr>
                                <td width="130" rowSpan="2" align="center" height="60">
                                  <p class="style11">Matrix
                                  Keyword</font></strong></p>
                                </td>
                                <td width="13" rowSpan="2" align="center" height="60"><img src="/Images/matrixleft.gif" border="0" width="9" height="55"></td>
                                <td width="29" align="center" height="35"><center><input class="textstyle" id="matrix1" maxLength="3" size="3" name="matrix1"></center></td>
                                <td width="29" align="center" height="35"><center><input class="textstyle" id="matrix2" maxLength="3" size="3" name="matrix2"></center></td>
                                <td width="9" rowSpan="2" align="center" height="60"><img src="/Images/matrixright.gif" border="0" width="9" height="55"></td>
                              </tr>
                              <tr>
                                <td width="29" align="center" height="35"><center><input class="textstyle" id="matrix3" maxLength="3" size="3" name="matrix3"></center></td>
                                <td width="29" align="center" height="35"><center><input class="textstyle" id="matrix4" maxLength="3" size="3" name="matrix4"></center></td>
                              </tr>
                            </tbody>
                          </table>
                        </td>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td width="751" height="196">
                    <p align="center" class="style9">Step2.
                   Encipher/Decipher</p>
                    <div align="center">
                      <center>
                      <table border="0" cellpadding="0" cellspacing="0" width="100%" height="229">
                        <tr>
                          <td width="50%" height="32">
                            <p class="style11">Plaintext</td>
                          <td width="50%" height="32">
                            <p class="style11"><strong>Ciphertext</strong></td>
                        </tr>
                        <tr>
                          <td width="50%" height="157">
                    <textarea name="input" cols="29" rows="7" wrap="VIRTUAL" class="textstyle" id="input"></textarea></td>
                          <td width="50%" height="157"><strong>
                    <textarea name="output" cols="29" rows="7" wrap="VIRTUAL" class="textstyle" id="output"></textarea></strong></td>
                        </tr>
                        <tr>
                          <td width="50%" valign="middle" height="40"><font face="Book Antiqua" size="3"><input name="Encipher" type="button" id="Encipher" value="Encrypt Plaintext" onClick="form.output.value=Hill_encipher(form.matrix1.value, form.matrix2.value, form.matrix3.value, form.matrix4.value, form.input.value)"></font></td>
                          <td width="50%" height="40"><font face="Book Antiqua" size="3"><input name="Decipher" type="button" id="Decipher" value="Decrypt Ciphertext" onClick="form.input.value=Hill_decipher(form.matrix1.value, form.matrix2.value, form.matrix3.value, form.matrix4.value, form.output.value)"></font></td>
                        </tr>
                      </table>
                      </center>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td width="751" height="32">
                    <table width="790" border="0" cellpadding="0" cellspacing="0" class="textstyle">
                      <tr>
                        <td width="271">&nbsp;</td>
                        <td width="82"></td>
                        <td width="40">&nbsp;</td>
                        <td width="83"><font face="Book Antiqua" size="3"><input type="button" name="Clear" id="Clear" value="Clear" onClick="form.input.value='', form.output.value='', form.matrix1.value='', form.matrix2.value='', form.matrix3.value='', form.matrix4.value=''"></font></td>
                        <td width="39">&nbsp;</td>
                        <td width="345"></td>
                      </tr>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td width="751" height="196">
                    <p align="center" class="style11"><strong></p>
                    <p align="center" class="style11"><strong>
                    <br>
                    </p>
                  </td>
                </tr>
              </table>
            </form>
          </td>
        </tr>
      </table>

      <p class="style12">&nbsp;</p>
    </td>

  </tr>

</table>
