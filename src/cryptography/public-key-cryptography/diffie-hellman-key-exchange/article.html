---
layout: default
title: Diffie-Hellman Key Exchange
---

<table width="933" height="725" border="0" cellpadding="0" cellspacing="0">

  <tr> 

    <td bgcolor="#FFFFFF" height="8" width="752"> 

      <table>
        <tr>
          <td width="766" bgColor="#ffffff" height="3">
            <p align="left" class="style12">Diffie- Hellman Key Agreement
            Protocol</p>
            <p style="LINE-HEIGHT: 150%" class="style8"><span style="mso-fareast-font-family: Times New Roman; mso-bidi-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">Diffie-Hellman
            Key Agreement protocol <a href="/links.html">[7]</a> can be used to
            exchange keys for a symmetric cryptosystem over an insecure
            channe</span>l</p>
            <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 150%; MARGIN-RIGHT: 0in" class="style9">Setup</p>
            <ul>
              <li>
                <p style="LINE-HEIGHT: 150%" class="style8"><i>p</i><span style="mso-spacerun: yes">&nbsp;is
                </span>a
                large prime number called the public prime</p>
              <li>
                <p style="LINE-HEIGHT: 150%" class="style8"><i>s is</i> a
                number in the range of 2 to <i>p</i>-1, called the public
                base</p>
              <li>
                <p style="LINE-HEIGHT: 150%" class="style8">Alice chooses a
                number <i>a</i> at random in the range of 2 to <i>p</i>-2, then
                calculates <i>A</i> = <i>s<sup>a</sup></i> mod <i>p</i>
                and sends it to Bob</p>
              <li>
                <p style="LINE-HEIGHT: 150%" class="style8">Bob chooses a number
                <i>b</i> at random in the range of 2 to <i>p</i>-2, then
                calculates <i>B</i> = <i>s<sup>b</sup></i> mod <i>p</i>
                and sends it to Alice</p>
              </li>
            </ul>
            <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 150%; MARGIN-RIGHT: 0in" class="style9">&nbsp;</p>
            <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 150%; MARGIN-RIGHT: 0in" class="style9">Key
            Retrieval</p>
            <ul>
              <li>
                <p style="LINE-HEIGHT: 150%" class="style8">Alice calculates <i>k</i>
                = <i>B<sup>a</sup></i> mod <i>p</i> = (<i>s<sup>b</sup>)<sup>a</sup></i>
                mod <i>p</i> = <i>s<sup>ba</sup></i> mod <i>p</i></p>
              <li>
                <p style="LINE-HEIGHT: 150%" class="style8">Bob calculates <i>k</i>
                = <i>A<sup>b</sup></i> mod <i>p</i> = (<i>s<sup>a</sup>)<sup>b</sup></i>
                mod <i>p</i> = <i>s<sup>ab</sup></i> mod <i>p</i></p>
              </li>
            </ul>
            <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 200%; MARGIN-RIGHT: 0in" class="style8">Now
            both Alice and Bob have the same key <i>k</i> and they can use
            it in a symmetric cryptosystem like DES. Since Alice knows <i>a</i>
            and <i>B</i> and Bob knows <i>b</i> and <i>A</i>,&nbsp; both of them can calculate
            <i>s<sup>ab</sup></i>. But someone with the knowledge of <i>p</i>,<i> s</i>,<i> A</i>,<i>
            B</i> will not be able to calculate the key <i>k</i></p>
            <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 200%; MARGIN-RIGHT: 0in" class="style9">The
            Diffie-
            Hellman Problem</p>
            <p style="LINE-HEIGHT: 200%" class="style8">Find <i>s<sup>ab</sup></i>
            mod <i>p</i> from <i>s<sup>a</sup></i> and<i> s<sup>b</sup></i>
            in a time-efficient manner.</p>
            <p style="LINE-HEIGHT: 200%" class="style8">It is obvious that for
            an eavesdropper, Eve, to find the key <i>k</i>, she has to find <i>a</i>
            and <i>b</i> given <i>s<sup>a</sup></i> = <i>A</i> mod <i>p</i> and<span style="mso-spacerun: yes">&nbsp; </span><i>S<sup>b</sup></i>
            = <i>B</i> mod <i>p</i> . There is no such efficient algorithm to solve for <i>a</i> and <i>b</i>.
            The Diffie- Hellman problem is still an open question without an
            efficient solution. You might want to try to crack it, rest assured you and
            your algorithm will be more famous than any of the existing
            algorithms related to cryptography. Good luck!</p>
            <p style="LINE-HEIGHT: 200%" class="style8">&nbsp;</p>
            <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 150%; MARGIN-RIGHT: 0in" class="style9">Example</p>
            <ul>
              <li>
                <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 200%; MARGIN-RIGHT: 0in; TEXT-ALIGN: justify" class="style8">Public
                prime <i>p</i> = 79<O:P>
                </O:P>
                </p>
              <li>
                <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 200%; MARGIN-RIGHT: 0in; TEXT-ALIGN: justify" class="style8">Public
                base<span style="mso-spacerun: yes">&nbsp;&nbsp; </span><i>s</i>
                = 56<O:P>
                </O:P>
                </p>
              <li>
                <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 200%; MARGIN-RIGHT: 0in; TEXT-ALIGN: justify" class="style8">Alice
                chooses <i>a</i>= 35<O:P>
                </O:P>
                </p>
              <li>
                <p style="LINE-HEIGHT: 200%" class="style8">Alice calculates <i>A</i><span style="mso-spacerun: yes">&nbsp;
                </span>= <i>s<sup>a</sup></i> mod <i>p = </i>(56)<sup>35</sup> mod
                79 =<span style="mso-spacerun: yes">&nbsp; </span><span class="MapleInput" style="font-weight: normal; mso-bidi-font-family: Times New Roman; mso-ascii-font-family: Times New Roman; mso-hansi-font-family: Times New Roman">15366711764103772265936719131269189389773889471090594389426176
                mod 79 = 24</span></p>
              <li>
                <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 200%; MARGIN-RIGHT: 0in; TEXT-ALIGN: justify" class="style8">Bob
                chooses <i>b</i>= 12<O:P>
                </O:P>
                </p>
              <li>
                <p style="LINE-HEIGHT: 200%" class="style8">Bob calculates <i>B</i><span style="mso-spacerun: yes">&nbsp;
                </span>= <i>s<sup>b</sup></i> mod <i>p</i><span style="mso-spacerun: yes">&nbsp;
                </span>= <i><span style="mso-spacerun: yes">&nbsp;</span></i>(56)<sup>12</sup>
                mod 79 = <span class="MapleInput" style="font-weight: normal; mso-bidi-font-family: Times New Roman; mso-ascii-font-family: Times New Roman; mso-hansi-font-family: Times New Roman">951166013805414055936</span><span class="MapleInput" style="font-weight: normal; mso-bidi-font-family: Times New Roman">
                mod 79 = 1</span> <O:P>
                </O:P>
                </p>
              <li>
                <p style="MARGIN-LEFT: 0in; LINE-HEIGHT: 200%; MARGIN-RIGHT: 0in; TEXT-ALIGN: justify" class="style8">Alice
                calculates key<span style="mso-spacerun: yes">&nbsp; </span><i>k</i>
                =<span style="mso-spacerun: yes">&nbsp; </span><i>B<sup>a</sup></i>
                mod <i>p</i> <i>= </i>(1)<sup>35</sup> mod 79 = 1 mod 79 = 1<O:P>
                </O:P>
                </p>
              <li>
                <p style="LINE-HEIGHT: 200%" class="style8">Bob calculates key <i>k</i>
                = <i>A<sup>b</sup></i> mod <i>p</i> <span style="mso-spacerun: yes">&nbsp;</span>=
                <i><span style="mso-spacerun: yes">&nbsp;</span></i>(24)<sup>12</sup>
                mod 79 = <span class="MapleInput" style="font-weight: normal; mso-bidi-font-family: Times New Roman">36520347436056576
                </span><span style="mso-spacerun: yes">&nbsp;</span>mod 79 = 1</p>
              </li>
            </ul>
          </td>
        </tr>
      </table>
    </td>

  </tr>

</table>
